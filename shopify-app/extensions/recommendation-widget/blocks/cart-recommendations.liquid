{{ 'widget.css' | asset_url | stylesheet_tag }}
<script src="{{ 'widget.js' | asset_url }}" defer></script>

{%- capture ai_cart_product_ids -%}
[
  {%- for item in cart.items -%}
    {{ item.product.id | json }}{%- unless forloop.last -%},{%- endunless -%}
  {%- endfor -%}
]
{%- endcapture -%}

<div
  data-ai-recommendations
  data-merchant="{{ shop.permanent_domain }}"
  data-customer-id="{{ customer.id }}"
  data-location="cart_page"
  data-cart-product-ids='{{ ai_cart_product_ids | strip }}'
  data-geo-location="{{ localization.country.iso_code }}"
  data-layout="{{ block.settings.layout }}"
  data-limit="{{ block.settings.items }}"
  data-title="{{ block.settings.title }}"
  data-subtitle="{{ block.settings.subtitle }}"
  data-primary-color="{{ block.settings.primary_color }}"
  data-api-base="auto"
  data-api-candidates="/apps/recommendations-prod,/apps/recommendations,/apps/recommendations-local"
></div>

{% schema %}
{
  "name": "AI Recs Cart",
  "target": "section",
  "templates": ["cart"],
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Widget title",
      "default": "Complete Your Order"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Widget subtitle",
      "default": "Customers who bought these items also added"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Layout",
      "options": [
        { "value": "list", "label": "List" },
        { "value": "carousel", "label": "Carousel" }
      ],
      "default": "list"
    },
    {
      "type": "range",
      "id": "items",
      "label": "Number of items",
      "min": 2,
      "max": 4,
      "step": 1,
      "default": 3
    },
    {
      "type": "color",
      "id": "primary_color",
      "label": "Primary color",
      "default": "#5c6ac4"
    }
  ]
}
{% endschema %}
